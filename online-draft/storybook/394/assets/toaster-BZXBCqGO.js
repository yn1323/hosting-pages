import{av as S,aw as R,ax as T,ay as F,c as k,s as D,az as W,aA as v,aB as x}from"./iframe-esjyWdrP.js";var M=k("toast").parts("group","root","title","description","actionTrigger","closeTrigger");M.build();var P=(e,a)=>e.getById(`toast-group:${a}`),{guards:w,createMachine:A}=D(),{and:N}=w;A({props({props:e}){return{dir:"ltr",id:F(),...e,store:e.store}},initialState({prop:e}){return e("store").attrs.overlap?"overlap":"stack"},refs(){return{lastFocusedEl:null,isFocusWithin:!1,isPointerWithin:!1,ignoreMouseTimer:x.create(),dismissableCleanup:void 0}},context({bindable:e}){return{toasts:e(()=>({defaultValue:[],sync:!0,hash:a=>a.map(o=>o.id).join(",")})),heights:e(()=>({defaultValue:[],sync:!0}))}},computed:{count:({context:e})=>e.get("toasts").length,overlap:({prop:e})=>e("store").attrs.overlap,placement:({prop:e})=>e("store").attrs.placement},effects:["subscribeToStore","trackDocumentVisibility","trackHotKeyPress"],watch({track:e,context:a,action:o}){e([()=>a.hash("toasts")],()=>{queueMicrotask(()=>{o(["collapsedIfEmpty","setDismissableBranch"])})})},exit:["clearDismissableBranch","clearLastFocusedEl","clearMouseEventTimer"],on:{"DOC.HOTKEY":{actions:["focusRegionEl"]},"REGION.BLUR":[{guard:N("isOverlapping","isPointerOut"),target:"overlap",actions:["collapseToasts","resumeToasts","restoreFocusIfPointerOut"]},{guard:"isPointerOut",target:"stack",actions:["resumeToasts","restoreFocusIfPointerOut"]},{actions:["clearFocusWithin"]}],"TOAST.REMOVE":{actions:["removeToast","removeHeight","ignoreMouseEventsTemporarily"]},"TOAST.PAUSE":{actions:["pauseToasts"]}},states:{stack:{on:{"REGION.POINTER_LEAVE":[{guard:"isOverlapping",target:"overlap",actions:["clearPointerWithin","resumeToasts","collapseToasts"]},{actions:["clearPointerWithin","resumeToasts"]}],"REGION.OVERLAP":{target:"overlap",actions:["collapseToasts"]},"REGION.FOCUS":{actions:["setLastFocusedEl","pauseToasts"]},"REGION.POINTER_ENTER":{actions:["setPointerWithin","pauseToasts"]}}},overlap:{on:{"REGION.STACK":{target:"stack",actions:["expandToasts"]},"REGION.POINTER_ENTER":{target:"stack",actions:["setPointerWithin","pauseToasts","expandToasts"]},"REGION.FOCUS":{target:"stack",actions:["setLastFocusedEl","pauseToasts","expandToasts"]}}}},implementations:{guards:{isOverlapping:({computed:e})=>e("overlap"),isPointerOut:({refs:e})=>!e.get("isPointerWithin")},effects:{subscribeToStore({context:e,prop:a}){const o=a("store");return e.set("toasts",o.getVisibleToasts()),o.subscribe(r=>{if(r.dismiss){e.set("toasts",i=>i.filter(n=>n.id!==r.id));return}e.set("toasts",i=>{const n=i.findIndex(d=>d.id===r.id);return n!==-1?[...i.slice(0,n),{...i[n],...r},...i.slice(n+1)]:[r,...i]})})},trackHotKeyPress({prop:e,send:a}){return v(document,"keydown",r=>{const{hotkey:i}=e("store").attrs;i.every(d=>r[d]||r.code===d)&&a({type:"DOC.HOTKEY"})},{capture:!0})},trackDocumentVisibility({prop:e,send:a,scope:o}){const{pauseOnPageIdle:r}=e("store").attrs;if(!r)return;const i=o.getDoc();return v(i,"visibilitychange",()=>{const n=i.visibilityState==="hidden";a({type:n?"PAUSE_ALL":"RESUME_ALL"})})}},actions:{setDismissableBranch({refs:e,context:a,computed:o,scope:r}){var h;const i=a.get("toasts"),n=o("placement"),d=i.length>0;if(!d){(h=e.get("dismissableCleanup"))==null||h();return}if(d&&e.get("dismissableCleanup"))return;const y=W(()=>P(r,n),{defer:!0});e.set("dismissableCleanup",y)},clearDismissableBranch({refs:e}){var a;(a=e.get("dismissableCleanup"))==null||a()},focusRegionEl({scope:e,computed:a}){queueMicrotask(()=>{var o;(o=P(e,a("placement")))==null||o.focus()})},pauseToasts({prop:e}){e("store").pause()},resumeToasts({prop:e}){e("store").resume()},expandToasts({prop:e}){e("store").expand()},collapseToasts({prop:e}){e("store").collapse()},removeToast({prop:e,event:a}){e("store").remove(a.id)},removeHeight({event:e,context:a}){(e==null?void 0:e.id)!=null&&queueMicrotask(()=>{a.set("heights",o=>o.filter(r=>r.id!==e.id))})},collapsedIfEmpty({send:e,computed:a}){!a("overlap")||a("count")>1||e({type:"REGION.OVERLAP"})},setLastFocusedEl({refs:e,event:a}){e.get("isFocusWithin")||!a.target||(e.set("isFocusWithin",!0),e.set("lastFocusedEl",a.target))},restoreFocusIfPointerOut({refs:e}){var a;!e.get("lastFocusedEl")||e.get("isPointerWithin")||((a=e.get("lastFocusedEl"))==null||a.focus({preventScroll:!0}),e.set("lastFocusedEl",null),e.set("isFocusWithin",!1))},setPointerWithin({refs:e}){e.set("isPointerWithin",!0)},clearPointerWithin({refs:e}){var a;e.set("isPointerWithin",!1),e.get("lastFocusedEl")&&!e.get("isFocusWithin")&&((a=e.get("lastFocusedEl"))==null||a.focus({preventScroll:!0}),e.set("lastFocusedEl",null))},clearFocusWithin({refs:e}){e.set("isFocusWithin",!1)},clearLastFocusedEl({refs:e}){var a;e.get("lastFocusedEl")&&((a=e.get("lastFocusedEl"))==null||a.focus({preventScroll:!0}),e.set("lastFocusedEl",null),e.set("isFocusWithin",!1))},ignoreMouseEventsTemporarily({refs:e}){e.get("ignoreMouseTimer").request()},clearMouseEventTimer({refs:e}){e.get("ignoreMouseTimer").cancel()}}}});var L=(e,a)=>({...a,...S(e)});function V(e={}){const a=L(e,{placement:"bottom",overlap:!1,max:24,gap:16,offsets:"1rem",hotkey:["altKey","KeyT"],removeDelay:200,pauseOnPageIdle:!0});let o=[],r=[],i=new Set,n=[];const d=s=>(o.push(s),()=>{const t=o.indexOf(s);o.splice(t,1)}),u=s=>(o.forEach(t=>t(s)),s),y=s=>{if(r.length>=a.max){n.push(s);return}u(s),r.unshift(s)},h=()=>{for(;n.length>0&&r.length<a.max;){const s=n.shift();s&&(u(s),r.unshift(s))}},l=s=>{const t=s.id??`toast:${F()}`,m=r.find(p=>p.id===t);return i.has(t)&&i.delete(t),m?r=r.map(p=>p.id===t?u({...p,...s,id:t}):p):y({id:t,duration:a.duration,removeDelay:a.removeDelay,type:"info",...s,stacked:!a.overlap,gap:a.gap}),t},O=s=>(i.add(s),s?(o.forEach(t=>t({id:s,dismiss:!0})),r=r.filter(t=>t.id!==s),h()):(r.forEach(t=>{o.forEach(m=>m({id:t.id,dismiss:!0}))}),r=[],n=[]),s);return{attrs:a,subscribe:d,create:l,update:(s,t)=>l({id:s,...t}),remove:O,dismiss:s=>{s!=null?r=r.map(t=>t.id===s?u({...t,message:"DISMISS"}):t):r=r.map(t=>u({...t,message:"DISMISS"}))},error:s=>l({...s,type:"error"}),success:s=>l({...s,type:"success"}),info:s=>l({...s,type:"info"}),warning:s=>l({...s,type:"warning"}),loading:s=>l({...s,type:"loading"}),getVisibleToasts:()=>r.filter(s=>!i.has(s.id)),getCount:()=>r.length,promise:(s,t,m={})=>{if(!t||!t.loading){R("[zag-js > toast] toaster.promise() requires at least a 'loading' option to be specified");return}const p=l({...m,...t.loading,promise:s,type:"loading"});let E=!0,f;const I=T(s).then(async c=>{if(f=["resolve",c],C(c)&&!c.ok){E=!1;const g=T(t.error,`HTTP Error! status: ${c.status}`);l({...m,...g,id:p,type:"error"})}else if(t.success!==void 0){E=!1;const g=T(t.success,c);l({...m,...g,id:p,type:"success"})}}).catch(async c=>{if(f=["reject",c],t.error!==void 0){E=!1;const g=T(t.error,c);l({...m,...g,id:p,type:"error"})}}).finally(()=>{var c;E&&O(p),(c=t.finally)==null||c.call(t)});return{id:p,unwrap:()=>new Promise((c,g)=>I.then(()=>f[0]==="reject"?g(f[1]):c(f[1])).catch(g))}},pause:s=>{s!=null?r=r.map(t=>t.id===s?u({...t,message:"PAUSE"}):t):r=r.map(t=>u({...t,message:"PAUSE"}))},resume:s=>{s!=null?r=r.map(t=>t.id===s?u({...t,message:"RESUME"}):t):r=r.map(t=>u({...t,message:"RESUME"}))},isVisible:s=>!i.has(s)&&!!r.find(t=>t.id===s),isDismissed:s=>i.has(s),expand:()=>{r=r.map(s=>u({...s,stacked:!0}))},collapse:()=>{r=r.map(s=>u({...s,stacked:!1}))}}}var C=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number";const H=e=>V(e),b=H({placement:"bottom-end",pauseOnPageIdle:!0}),ae=()=>{const e={duration:3e3,closable:!0};return{successToast:r=>{b.create({description:r,type:"success",...e})},errorToast:r=>{b.create({description:r,type:"error",...e})}}};export{ae as u};
