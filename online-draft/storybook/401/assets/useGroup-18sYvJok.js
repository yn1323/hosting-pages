import{b as g,d as f}from"./common-CxXojnM3.js";import{c as w,e as m,s as n,d as c,g as u,u as h}from"./index.esm-ClM2GOLW.js";import{r as s}from"./iframe-C_rgkzEe.js";const b=()=>{const o=w(f,"app/onlinedraft/group"),d=s.useCallback(async a=>{g(a,50,"グループ名");const r={groupName:a.trim(),deleteFlg:!1,finishedRound:[],round:1};try{return(await m(o,{...r,createdAt:n(),updatedAt:n()})).id}catch(t){throw t instanceof Error?new Error(`グループ作成に失敗しました: ${t.message}`):new Error("グループ作成中に予期しないエラーが発生しました")}},[o]),i=s.useCallback(async a=>{var r;const t=c(o,a),e=await u(t);return e.exists()&&!(!((r=e.data())===null||r===void 0)&&r.deleteFlg)},[o]),p=s.useCallback(async a=>{try{const r=c(o,a),t=await u(r);if(!t.exists())throw new Error("グループが見つかりません");const l=t.data().round+1;await h(r,{round:l,updatedAt:n()})}catch(r){throw console.error("ラウンド更新に失敗しました:",r),r}},[o]);return{createGroup:d,checkGroupExists:i,incrementRound:p,groupCollection:o}};export{b as u};
